syntax = "proto3";

package cropfresh.payment;

service PaymentService {
  rpc InitiatePayment(InitiatePaymentRequest) returns (InitiatePaymentResponse);
  rpc VerifyPayment(VerifyPaymentRequest) returns (VerifyPaymentResponse);
  rpc ProcessRefund(ProcessRefundRequest) returns (ProcessRefundResponse);
  rpc GetTransactionHistory(GetTransactionHistoryRequest) returns (GetTransactionHistoryResponse);
}

message InitiatePaymentRequest {
  string order_id = 1;
  double amount = 2;
  string buyer_id = 3;
  string payment_method = 4; // upi, card, wallet
}

message InitiatePaymentResponse {
  string payment_id = 1;
  string payment_url = 2;
  string transaction_id = 3;
}

message VerifyPaymentRequest {
  string payment_id = 1;
  string transaction_id = 2;
}

message VerifyPaymentResponse {
  bool success = 1;
  string status = 2; // success, failed, pending
  string timestamp = 3;
}

message ProcessRefundRequest {
  string payment_id = 1;
  double amount = 2;
  string reason = 3;
}

message ProcessRefundResponse {
  bool success = 1;
  string refund_id = 2;
  string estimated_arrival = 3;
}

message GetTransactionHistoryRequest {
  string user_id = 1;
  int32 page = 2;
  int32 limit = 3;
}

message Transaction {
  string transaction_id = 1;
  double amount = 2;
  string type = 3; // payment, refund, payout
  string status = 4;
  string timestamp = 5;
}

message GetTransactionHistoryResponse {
  repeated Transaction transactions = 1;
  int32 total = 2;
}
